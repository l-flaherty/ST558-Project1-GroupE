---
title: "ST558 Project 1"
author: "Flaherty and Lu"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

# This is a development branch from Jia Lu.

## Data Processing

### First steps

1. Read in data, select only columns (Area_name, STCOU, any colum that ends in "D"), and rename column Area_name as area_name.

```{r}
library(tidyverse)
edu01a_data <- read_csv("https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv") |> 
  select(Area_name, STCOU, ends_with("D")) |>
  rename("area_name" = "Area_name")
edu01a_data
```

2. Convert the data into long format where each row has only one enrollment value for that area_name.

```{r}
edu01a_data <- edu01a_data |> 
  pivot_longer(cols = EDU010187D : EDU010196D,
               names_to = "enrollment",
               values_to = "value")
edu01a_data
```

3. Parse the string from the "Enrollment" column to pull out the year, and convert the year into a numeric value. Grab the first three characters and following four digits to create a new variable.

```{r}
edu01a_data <- edu01a_data |> 
  mutate(measurement = substr(edu01a_data$enrollment, 1, 7)) |> 
  mutate(year = substr(edu01a_data$enrollment, 8, 9)) 

edu01a_data$year <- year(parse_date_time(edu01a_data$year, "y"))
edu01a_data
```

4. Creating two data sets:
- One data set that contains only non-county data. Add a class to the tibble called state.
- One data set that contains only county level data. Add a class to the tibble called county

```{r}
county_index <- grep(pattern = ", \\w\\w", edu01a_data$area_name)

county_data <- edu01a_data[county_index,]
class(county_data) <- c("county", class(county_data))

non_county_data <- edu01a_data[- county_index,]
class(non_county_data) <- c("state", class(non_county_data))
```

