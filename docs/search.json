[
  {
    "objectID": "ST558 Project 1 Quarto Doc.html",
    "href": "ST558 Project 1 Quarto Doc.html",
    "title": "ST558 Project 1",
    "section": "",
    "text": "Read in data, select only columns (Area_name, STCOU, any colum that ends in “D”), and rename column Area_name as area_name.\n\n\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.3.3\n\n\nWarning: package 'ggplot2' was built under R version 4.3.3\n\n\nWarning: package 'readr' was built under R version 4.3.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nedu01a_data &lt;- read_csv(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv\") |&gt; \n  select(Area_name, STCOU, ends_with(\"D\")) |&gt;\n  rename(\"area_name\" = \"Area_name\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010187N1, EDU010187N2, EDU010188N1, EDU010188...\ndbl (20): EDU010187F, EDU010187D, EDU010188F, EDU010188D, EDU010189F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nedu01a_data\n\n# A tibble: 3,198 × 12\n   area_name     STCOU EDU010187D EDU010188D EDU010189D EDU010190D EDU010191D\n   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n 1 UNITED STATES 00000   40024299   39967624   40317775   40737600   41385442\n 2 ALABAMA       01000     733735     728234     730048     728252     725541\n 3 Autauga, AL   01001       6829       6900       6920       6847       7008\n 4 Baldwin, AL   01003      16417      16465      16799      17054      17479\n 5 Barbour, AL   01005       5071       5098       5068       5156       5173\n 6 Bibb, AL      01007       3557       3508       3571       3621       3652\n 7 Blount, AL    01009       7319       7223       7205       7209       7155\n 8 Bullock, AL   01011       2014       1980       1985       1983       1985\n 9 Butler, AL    01013       4640       4582       4610       4591       4544\n10 Calhoun, AL   01015      20939      20923      20907      20849      20768\n# ℹ 3,188 more rows\n# ℹ 5 more variables: EDU010192D &lt;dbl&gt;, EDU010193D &lt;dbl&gt;, EDU010194D &lt;dbl&gt;,\n#   EDU010195D &lt;dbl&gt;, EDU010196D &lt;dbl&gt;\n\n\n\nConvert the data into long format where each row has only one enrollment value for that area_name.\n\n\nedu01a_data &lt;- read_csv(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv\") |&gt; \n  select(Area_name, STCOU, ends_with(\"D\")) |&gt;\n  rename(\"area_name\" = \"Area_name\") |&gt; \n  pivot_longer(cols = is.numeric,\n               names_to = \"enrollment\",\n               values_to = \"value\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010187N1, EDU010187N2, EDU010188N1, EDU010188...\ndbl (20): EDU010187F, EDU010187D, EDU010188F, EDU010188D, EDU010189F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: Use of bare predicate functions was deprecated in tidyselect 1.1.0.\nℹ Please use wrap predicates in `where()` instead.\n  # Was:\n  data %&gt;% select(is.numeric)\n\n  # Now:\n  data %&gt;% select(where(is.numeric))\n\nedu01a_data\n\n# A tibble: 31,980 × 4\n   area_name     STCOU enrollment    value\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;\n 1 UNITED STATES 00000 EDU010187D 40024299\n 2 UNITED STATES 00000 EDU010188D 39967624\n 3 UNITED STATES 00000 EDU010189D 40317775\n 4 UNITED STATES 00000 EDU010190D 40737600\n 5 UNITED STATES 00000 EDU010191D 41385442\n 6 UNITED STATES 00000 EDU010192D 42088151\n 7 UNITED STATES 00000 EDU010193D 42724710\n 8 UNITED STATES 00000 EDU010194D 43369917\n 9 UNITED STATES 00000 EDU010195D 43993459\n10 UNITED STATES 00000 EDU010196D 44715737\n# ℹ 31,970 more rows\n\n\n\nParse the string from the “Enrollment” column to pull out the year, and convert the year into a numeric value. Grab the first three characters and following four digits to create a new variable.\n\n\nedu01a_data &lt;- edu01a_data |&gt; \n  mutate(measurement = substr(enrollment, 1, 7)) |&gt; \n  mutate(year = substr(enrollment, 8, 9))\n\nedu01a_data$year &lt;- year(parse_date_time(edu01a_data$year, \"y\"))\nedu01a_data\n\n# A tibble: 31,980 × 6\n   area_name     STCOU enrollment    value measurement  year\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;\n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987\n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988\n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989\n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990\n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991\n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992\n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993\n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994\n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995\n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996\n# ℹ 31,970 more rows\n\n\n\nCreating two data sets:\n\n\nOne data set that contains only non-county data. Add a class to the tibble called state.\nOne data set that contains only county level data. Add a class to the tibble called county\n\n\ncounty_index &lt;- grep(pattern = \", \\\\w\\\\w\", edu01a_data$area_name)\n\ncounty_data &lt;- edu01a_data[county_index,]\ncounty_data\n\n# A tibble: 31,450 × 6\n   area_name   STCOU enrollment value measurement  year\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987\n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988\n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989\n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990\n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991\n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992\n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993\n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994\n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995\n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996\n# ℹ 31,440 more rows\n\nclass(county_data) &lt;- c(\"county\", class(county_data))\nclass(county_data)\n\n[1] \"county\"     \"tbl_df\"     \"tbl\"        \"data.frame\"\n\nnon_county_data &lt;- edu01a_data[- county_index,]\nnon_county_data\n\n# A tibble: 530 × 6\n   area_name     STCOU enrollment    value measurement  year\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;\n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987\n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988\n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989\n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990\n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991\n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992\n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993\n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994\n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995\n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996\n# ℹ 520 more rows\n\nclass(non_county_data) &lt;- c(\"state\", class(non_county_data))\nclass(non_county_data)\n\n[1] \"state\"      \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\n\nFor the county level tibble, create a new variable that describes which state one of these county measurements corresponds to (the two digit abbreviation).\n\n\ncounty_data &lt;- county_data |&gt; \n  mutate(state = substr(county_data$area_name, nchar(county_data$area_name) - 1, nchar(county_data$area_name)))\ncounty_data\n\n# A tibble: 31,450 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987 AL   \n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988 AL   \n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989 AL   \n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990 AL   \n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991 AL   \n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992 AL   \n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993 AL   \n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994 AL   \n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995 AL   \n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996 AL   \n# ℹ 31,440 more rows\n\n\n\nFor the non-county level tibble, create a new variable called “division” corresponding to the state’s classification of division here. If row corresponds to a non-state (i.e. UNITED STATES), return ERROR for the division.\n\n\nnon_county_data &lt;- non_county_data |&gt;\n  mutate(division = ifelse(non_county_data$area_name %in% c(\"CONNECTICUT\", \"MAINE\", \"MASSACHUSETTS\", \"NEW HAMPSHIRE\", \"RHODE ISLAND\", \"VERMONT\"),\"Division 1\", \n                           ifelse(non_county_data$area_name %in% c(\"NEW JERSEY\", \"NEW YORK\", \"PENNSYLVANIA\"), \"Division 2\", \n                                  ifelse(non_county_data$area_name %in% c(\"ILLINOIS\", \"INDIANA\", \"MICHIGAN\", \"OHIO\", \"WISCONSIN\"), \"Division 3\",\n                                         ifelse(non_county_data$area_name %in% c(\"IOWA\", \"KANSAS\", \"MINNESOTA\", \"MISSOURI\", \"NEBRASKA\", \"NORTH DAKOTA\", \"SOUTH DAKOTA\"), \"Division 4\",\n                                                ifelse(non_county_data$area_name %in% c(\"DELAWARE\", \"FLORIDA\", \"GEORGIA\", \"MARYLAND\", \"NORTH CAROLINA\", \"SOUTH CAROLINA\", \"VIRGINIA\", \"DISTRICT OF COLUMBIA\", \"District of Columbia\", \"WEST VIRGINIA\"), \"Division 5\",\n                                                       ifelse(non_county_data$area_name %in% c(\"ALABAMA\", \"KENTUCKY\", \"MISSISSIPPI\", \"TENNESSEE\"), \"Division 6\",\n                                                              ifelse(non_county_data$area_name %in% c(\"ARKANSAS\", \"LOUISIANA\", \"OKLAHOMA\", \"TEXAS\"), \"Division 7\",\n                                                                     ifelse(non_county_data$area_name %in% c(\"ARIZONA\", \"COLORADO\", \"IDAHO\", \"MONTANA\", \"NEVADA\", \"NEW MEXICO\", \"UTAH\", \"WYOMING\"), \"Division 8\",\n                                                                            ifelse(non_county_data$area_name %in% c(\"ALASKA\", \"CALIFORNIA\", \"HAWAII\", \"OREGON\", \"WASHINGTON\"), \"Division 9\",\n                                                                                   \"ERROR\"))))))))))\nnon_county_data\n\n# A tibble: 530 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987 ERROR   \n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988 ERROR   \n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989 ERROR   \n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990 ERROR   \n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991 ERROR   \n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992 ERROR   \n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993 ERROR   \n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994 ERROR   \n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995 ERROR   \n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996 ERROR   \n# ℹ 520 more rows\n\n\n\n\n\n\n\nWrite one function that does steps 1 & 2 above. Give an optional argument that allows the user to specify the name of the column representing the value (enrollment for these data sets).\n\n\nfunction_for_step_1_2 &lt;- function(url, default_var_name = \"value\") {\n  tmp &lt;- read_csv(url) |&gt;\n    select(Area_name, STCOU, ends_with(\"D\")) |&gt;\n    rename(\"area_name\" = \"Area_name\") |&gt;   \n    pivot_longer(cols = is.numeric,\n                 names_to = \"enrollment\",\n                 values_to = default_var_name)\n  return(tmp)\n}\n\n\nWrite another function that takes in the output of step 2 and does step 3 above.\n\n\nfunction_for_step_3 &lt;- function(tmp) {\n  tmp &lt;- tmp |&gt; \n    mutate(measurement = substr(enrollment, 1, 7)) |&gt;\n    mutate(year = substr(enrollment, 8, 9))\n  \n  tmp$year &lt;- year(parse_date_time(tmp$year, \"y\"))\n  return(tmp)\n}\n\n\nWrite a function to do step 5.\n\n\nfunction_for_step_5 &lt;- function(county_data) {\n  county_data &lt;- county_data |&gt; \n    mutate(state = substr(county_data$area_name, nchar(county_data$area_name) - 1, nchar(county_data$area_name)))\n  return(county_data)\n}\n\n\nWrite a function to do step 6.\n\n\nfunction_for_step_6 &lt;- function(non_county_data) {\n  non_county_data &lt;- non_county_data |&gt;\n    mutate(division = ifelse(non_county_data$area_name %in% c(\"CONNECTICUT\", \"MAINE\", \"MASSACHUSETTS\", \"NEW HAMPSHIRE\", \"RHODE ISLAND\", \"VERMONT\"),\"Division 1\", \n                             ifelse(non_county_data$area_name %in% c(\"NEW JERSEY\", \"NEW YORK\", \"PENNSYLVANIA\"), \"Division 2\", \n                                    ifelse(non_county_data$area_name %in% c(\"ILLINOIS\", \"INDIANA\", \"MICHIGAN\", \"OHIO\", \"WISCONSIN\"), \"Division 3\",\n                                           ifelse(non_county_data$area_name %in% c(\"IOWA\", \"KANSAS\", \"MINNESOTA\", \"MISSOURI\", \"NEBRASKA\", \"NORTH DAKOTA\", \"SOUTH DAKOTA\"), \"Division 4\",\n                                                  ifelse(non_county_data$area_name %in% c(\"DELAWARE\", \"FLORIDA\", \"GEORGIA\", \"MARYLAND\", \"NORTH CAROLINA\", \"SOUTH CAROLINA\", \"VIRGINIA\", \"DISTRICT OF COLUMBIA\", \"District of Columbia\", \"WEST VIRGINIA\"), \"Division 5\",\n                                                         ifelse(non_county_data$area_name %in% c(\"ALABAMA\", \"KENTUCKY\", \"MISSISSIPPI\", \"TENNESSEE\"), \"Division 6\",\n                                                                ifelse(non_county_data$area_name %in% c(\"ARKANSAS\", \"LOUISIANA\", \"OKLAHOMA\", \"TEXAS\"), \"Division 7\",\n                                                                       ifelse(non_county_data$area_name %in% c(\"ARIZONA\", \"COLORADO\", \"IDAHO\", \"MONTANA\", \"NEVADA\", \"NEW MEXICO\", \"UTAH\", \"WYOMING\"), \"Division 8\",\n                                                                              ifelse(non_county_data$area_name %in% c(\"ALASKA\", \"CALIFORNIA\", \"HAWAII\", \"OREGON\", \"WASHINGTON\"), \"Division 9\",\n                                                                                     \"ERROR\"))))))))))\n  return(non_county_data)\n}\n\n\nWrite another function that takes in the output from step 3 and creates the two tibbles in step 4, calls the above two functions (to perform steps 5 and 6), and returns two final tibbles.\n\n\nfunction_for_steps4_5_6 &lt;- function(tmp) {\n  county_index &lt;- grep(pattern = \", \\\\w\\\\w\", tmp$area_name)\n  county_data &lt;- tmp[county_index,]\n  class(county_data) &lt;- c(\"county\", class(county_data))\n  non_county_data &lt;- tmp[- county_index,]\n  class(non_county_data) &lt;- c(\"state\", class(non_county_data))\n  county_data &lt;- county_data |&gt; function_for_step_5 ()\n  non_county_data &lt;- non_county_data |&gt; function_for_step_6 ()\n  return(list(county_data, non_county_data))\n} \n\n\nCreating a wrapper function that takes in the URL of a .csv file in this format and the optional argument for the variable name, calls the functions you wrote above, and then returns the two tibbles.\n\n\nmy_wrapper &lt;- function(url, default_var_name = \"value\") {\n  result &lt;- function_for_step_1_2(url, default_var_name) |&gt;\n    function_for_step_3() |&gt;\n    function_for_steps4_5_6 ()\n  return(result)\n}\n\n\n\n\nCall the function two times and parse the two .csv files mentioned so far.\n\n\nedu01a_data_from_wrapper &lt;- my_wrapper(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010187N1, EDU010187N2, EDU010188N1, EDU010188...\ndbl (20): EDU010187F, EDU010187D, EDU010188F, EDU010188D, EDU010189F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nedu01a_data_from_wrapper\n\n[[1]]\n# A tibble: 31,450 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987 AL   \n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988 AL   \n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989 AL   \n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990 AL   \n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991 AL   \n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992 AL   \n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993 AL   \n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994 AL   \n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995 AL   \n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996 AL   \n# ℹ 31,440 more rows\n\n[[2]]\n# A tibble: 530 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987 ERROR   \n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988 ERROR   \n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989 ERROR   \n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990 ERROR   \n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991 ERROR   \n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992 ERROR   \n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993 ERROR   \n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994 ERROR   \n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995 ERROR   \n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996 ERROR   \n# ℹ 520 more rows\n\nedu01b_data_from_wrapper &lt;-\nmy_wrapper(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01b.csv\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010197N1, EDU010197N2, EDU010198N1, EDU010198...\ndbl (20): EDU010197F, EDU010197D, EDU010198F, EDU010198D, EDU010199F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nedu01b_data_from_wrapper\n\n[[1]]\n# A tibble: 31,450 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010197D  8099 EDU0101      1997 AL   \n 2 Autauga, AL 01001 EDU010198D  8211 EDU0101      1998 AL   \n 3 Autauga, AL 01001 EDU010199D  8489 EDU0101      1999 AL   \n 4 Autauga, AL 01001 EDU010200D  8912 EDU0102      2000 AL   \n 5 Autauga, AL 01001 EDU010201D  8626 EDU0102      2001 AL   \n 6 Autauga, AL 01001 EDU010202D  8762 EDU0102      2002 AL   \n 7 Autauga, AL 01001 EDU015203D  9105 EDU0152      2003 AL   \n 8 Autauga, AL 01001 EDU015204D  9200 EDU0152      2004 AL   \n 9 Autauga, AL 01001 EDU015205D  9559 EDU0152      2005 AL   \n10 Autauga, AL 01001 EDU015206D  9652 EDU0152      2006 AL   \n# ℹ 31,440 more rows\n\n[[2]]\n# A tibble: 530 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010197D 44534459 EDU0101      1997 ERROR   \n 2 UNITED STATES 00000 EDU010198D 46245814 EDU0101      1998 ERROR   \n 3 UNITED STATES 00000 EDU010199D 46368903 EDU0101      1999 ERROR   \n 4 UNITED STATES 00000 EDU010200D 46818690 EDU0102      2000 ERROR   \n 5 UNITED STATES 00000 EDU010201D 47127066 EDU0102      2001 ERROR   \n 6 UNITED STATES 00000 EDU010202D 47606570 EDU0102      2002 ERROR   \n 7 UNITED STATES 00000 EDU015203D 48506317 EDU0152      2003 ERROR   \n 8 UNITED STATES 00000 EDU015204D 48693287 EDU0152      2004 ERROR   \n 9 UNITED STATES 00000 EDU015205D 48978555 EDU0152      2005 ERROR   \n10 UNITED STATES 00000 EDU015206D 49140702 EDU0152      2006 ERROR   \n# ℹ 520 more rows\n\n\n\nWrite a single short function that takes in the results of two calls to the wrapper function.\n\n\ncombining_data &lt;- function(tmp_1, tmp_2) {\n  county_data_combined &lt;- dplyr::bind_rows(tmp_1[[1]], tmp_2[[1]])\n  non_county_data_combined &lt;- dplyr::bind_rows(tmp_1[[2]], tmp_2[[2]])\n  tmp_3 &lt;- list(county_data_combined, non_county_data_combined)\n  return(tmp_3)\n}\n\ndata_combined &lt;- combining_data(edu01a_data_from_wrapper, edu01b_data_from_wrapper)\ndata_combined\n\n[[1]]\n# A tibble: 62,900 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987 AL   \n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988 AL   \n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989 AL   \n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990 AL   \n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991 AL   \n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992 AL   \n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993 AL   \n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994 AL   \n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995 AL   \n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996 AL   \n# ℹ 62,890 more rows\n\n[[2]]\n# A tibble: 1,060 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987 ERROR   \n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988 ERROR   \n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989 ERROR   \n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990 ERROR   \n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991 ERROR   \n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992 ERROR   \n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993 ERROR   \n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994 ERROR   \n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995 ERROR   \n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996 ERROR   \n# ℹ 1,050 more rows\n\n\n\n\n\n\n\n\n\nWrite a function that plots the mean value of the statistic (enrollment for this data set) across the years for each Division. That is, on the x-axis we want the numeric year value, on the y-axis we want the mean of the statistic for each Division and numeric year. Remove observations at the ERROR setting of Division.\nplot the data with year as x-axis and mean enrollment value as y-axis for different divisions\n\n\nplot.state &lt;- function(combined_state_data, default_var_name = value) {\n  combined_state_data &lt;- combined_state_data |&gt;\n    filter(division != \"ERROR\") |&gt;\n    group_by(division, year) |&gt;\n    summarize(mean_value = mean({{default_var_name}}))\n\n  ggplot(combined_state_data, aes(x = year, y = mean_value, color = division)) +\n    geom_line() +\n    labs(x = \"Year\",\n         y = \"Mean Enrollment Value\",\n         color = \"Division\",\n         title = \"Mean Enrollment Value by Year and Division\")\n}\n\nplot.state(combined_state_data = data_combined[[2]], default_var_name = value)\n\n`summarise()` has grouped output by 'division'. You can override using the\n`.groups` argument.\n\n\n\n\n\n\n\n\n\n\n\n\n\nfilter the data to only include data from the state specified\nfind the overall mean of the statistic (use get(var_name) here as well) for each Area_name and sort those values from largest to smallest if ‘top’ is specified or smallest to largest if ‘bottom’ is specified\nobtain the top or bottom x number of Area_names from the previous step where x is given by the user or the default\nfilter the data for this state to only include the Area_name’s from the previous part\nplot the data with year as x-axis and original enrollment value as y-axis for counties refereed in query\n\n\nplot.county &lt;- function(combined_county_data, default_state = \"NC\", default_var_name = value, top_or_bottom = \"top\", default_obs = 5){\n  \n  if (top_or_bottom == \"top\") {\n    area_name_for_plot &lt;- combined_county_data |&gt;\n      filter(state == default_state) |&gt;\n      group_by(area_name) |&gt;\n      summarize(mean_value = mean({{default_var_name}})) |&gt;\n      arrange(desc(mean_value)) |&gt;\n      slice(1:default_obs) |&gt;\n      pull(area_name)\n    \n    area_name_for_plot\n  } else if (top_or_bottom == \"bottom\") {\n    area_name_for_plot &lt;- combined_county_data |&gt;\n      filter(state == default_state) |&gt;\n      group_by(area_name) |&gt;\n      summarize(mean_value = mean({{default_var_name}})) |&gt;\n      arrange(mean_value) |&gt;\n      slice(1:default_obs) |&gt;\n      pull(area_name)\n    \n    area_name_for_plot\n  } \n  \n  plot_state &lt;- data_combined[[1]] |&gt;\n    filter(area_name %in% area_name_for_plot)\n  \n  ggplot(plot_state, aes(x = year, y = value, color = area_name)) +\n    geom_line() +\n    labs(x = \"Year\",\n         y = \"Enrollment Value\",\n         color = \"Area_name\",\n         title = \"Enrollment Value by Year in Counties Referred\")\n}\n\nplot.county(combined_county_data = data_combined[[1]], default_state = \"CA\", default_var_name = value, top_or_bottom = \"bottom\", default_obs = 10)"
  },
  {
    "objectID": "ST558 Project 1 Quarto Doc.html#data-processing",
    "href": "ST558 Project 1 Quarto Doc.html#data-processing",
    "title": "ST558 Project 1",
    "section": "",
    "text": "Read in data, select only columns (Area_name, STCOU, any colum that ends in “D”), and rename column Area_name as area_name.\n\n\nlibrary(tidyverse)\n\nWarning: package 'tidyverse' was built under R version 4.3.3\n\n\nWarning: package 'ggplot2' was built under R version 4.3.3\n\n\nWarning: package 'readr' was built under R version 4.3.3\n\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nedu01a_data &lt;- read_csv(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv\") |&gt; \n  select(Area_name, STCOU, ends_with(\"D\")) |&gt;\n  rename(\"area_name\" = \"Area_name\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010187N1, EDU010187N2, EDU010188N1, EDU010188...\ndbl (20): EDU010187F, EDU010187D, EDU010188F, EDU010188D, EDU010189F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nedu01a_data\n\n# A tibble: 3,198 × 12\n   area_name     STCOU EDU010187D EDU010188D EDU010189D EDU010190D EDU010191D\n   &lt;chr&gt;         &lt;chr&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;      &lt;dbl&gt;\n 1 UNITED STATES 00000   40024299   39967624   40317775   40737600   41385442\n 2 ALABAMA       01000     733735     728234     730048     728252     725541\n 3 Autauga, AL   01001       6829       6900       6920       6847       7008\n 4 Baldwin, AL   01003      16417      16465      16799      17054      17479\n 5 Barbour, AL   01005       5071       5098       5068       5156       5173\n 6 Bibb, AL      01007       3557       3508       3571       3621       3652\n 7 Blount, AL    01009       7319       7223       7205       7209       7155\n 8 Bullock, AL   01011       2014       1980       1985       1983       1985\n 9 Butler, AL    01013       4640       4582       4610       4591       4544\n10 Calhoun, AL   01015      20939      20923      20907      20849      20768\n# ℹ 3,188 more rows\n# ℹ 5 more variables: EDU010192D &lt;dbl&gt;, EDU010193D &lt;dbl&gt;, EDU010194D &lt;dbl&gt;,\n#   EDU010195D &lt;dbl&gt;, EDU010196D &lt;dbl&gt;\n\n\n\nConvert the data into long format where each row has only one enrollment value for that area_name.\n\n\nedu01a_data &lt;- read_csv(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv\") |&gt; \n  select(Area_name, STCOU, ends_with(\"D\")) |&gt;\n  rename(\"area_name\" = \"Area_name\") |&gt; \n  pivot_longer(cols = is.numeric,\n               names_to = \"enrollment\",\n               values_to = \"value\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010187N1, EDU010187N2, EDU010188N1, EDU010188...\ndbl (20): EDU010187F, EDU010187D, EDU010188F, EDU010188D, EDU010189F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: Use of bare predicate functions was deprecated in tidyselect 1.1.0.\nℹ Please use wrap predicates in `where()` instead.\n  # Was:\n  data %&gt;% select(is.numeric)\n\n  # Now:\n  data %&gt;% select(where(is.numeric))\n\nedu01a_data\n\n# A tibble: 31,980 × 4\n   area_name     STCOU enrollment    value\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;\n 1 UNITED STATES 00000 EDU010187D 40024299\n 2 UNITED STATES 00000 EDU010188D 39967624\n 3 UNITED STATES 00000 EDU010189D 40317775\n 4 UNITED STATES 00000 EDU010190D 40737600\n 5 UNITED STATES 00000 EDU010191D 41385442\n 6 UNITED STATES 00000 EDU010192D 42088151\n 7 UNITED STATES 00000 EDU010193D 42724710\n 8 UNITED STATES 00000 EDU010194D 43369917\n 9 UNITED STATES 00000 EDU010195D 43993459\n10 UNITED STATES 00000 EDU010196D 44715737\n# ℹ 31,970 more rows\n\n\n\nParse the string from the “Enrollment” column to pull out the year, and convert the year into a numeric value. Grab the first three characters and following four digits to create a new variable.\n\n\nedu01a_data &lt;- edu01a_data |&gt; \n  mutate(measurement = substr(enrollment, 1, 7)) |&gt; \n  mutate(year = substr(enrollment, 8, 9))\n\nedu01a_data$year &lt;- year(parse_date_time(edu01a_data$year, \"y\"))\nedu01a_data\n\n# A tibble: 31,980 × 6\n   area_name     STCOU enrollment    value measurement  year\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;\n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987\n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988\n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989\n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990\n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991\n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992\n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993\n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994\n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995\n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996\n# ℹ 31,970 more rows\n\n\n\nCreating two data sets:\n\n\nOne data set that contains only non-county data. Add a class to the tibble called state.\nOne data set that contains only county level data. Add a class to the tibble called county\n\n\ncounty_index &lt;- grep(pattern = \", \\\\w\\\\w\", edu01a_data$area_name)\n\ncounty_data &lt;- edu01a_data[county_index,]\ncounty_data\n\n# A tibble: 31,450 × 6\n   area_name   STCOU enrollment value measurement  year\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987\n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988\n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989\n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990\n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991\n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992\n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993\n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994\n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995\n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996\n# ℹ 31,440 more rows\n\nclass(county_data) &lt;- c(\"county\", class(county_data))\nclass(county_data)\n\n[1] \"county\"     \"tbl_df\"     \"tbl\"        \"data.frame\"\n\nnon_county_data &lt;- edu01a_data[- county_index,]\nnon_county_data\n\n# A tibble: 530 × 6\n   area_name     STCOU enrollment    value measurement  year\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt;\n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987\n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988\n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989\n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990\n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991\n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992\n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993\n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994\n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995\n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996\n# ℹ 520 more rows\n\nclass(non_county_data) &lt;- c(\"state\", class(non_county_data))\nclass(non_county_data)\n\n[1] \"state\"      \"tbl_df\"     \"tbl\"        \"data.frame\"\n\n\n\nFor the county level tibble, create a new variable that describes which state one of these county measurements corresponds to (the two digit abbreviation).\n\n\ncounty_data &lt;- county_data |&gt; \n  mutate(state = substr(county_data$area_name, nchar(county_data$area_name) - 1, nchar(county_data$area_name)))\ncounty_data\n\n# A tibble: 31,450 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987 AL   \n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988 AL   \n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989 AL   \n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990 AL   \n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991 AL   \n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992 AL   \n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993 AL   \n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994 AL   \n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995 AL   \n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996 AL   \n# ℹ 31,440 more rows\n\n\n\nFor the non-county level tibble, create a new variable called “division” corresponding to the state’s classification of division here. If row corresponds to a non-state (i.e. UNITED STATES), return ERROR for the division.\n\n\nnon_county_data &lt;- non_county_data |&gt;\n  mutate(division = ifelse(non_county_data$area_name %in% c(\"CONNECTICUT\", \"MAINE\", \"MASSACHUSETTS\", \"NEW HAMPSHIRE\", \"RHODE ISLAND\", \"VERMONT\"),\"Division 1\", \n                           ifelse(non_county_data$area_name %in% c(\"NEW JERSEY\", \"NEW YORK\", \"PENNSYLVANIA\"), \"Division 2\", \n                                  ifelse(non_county_data$area_name %in% c(\"ILLINOIS\", \"INDIANA\", \"MICHIGAN\", \"OHIO\", \"WISCONSIN\"), \"Division 3\",\n                                         ifelse(non_county_data$area_name %in% c(\"IOWA\", \"KANSAS\", \"MINNESOTA\", \"MISSOURI\", \"NEBRASKA\", \"NORTH DAKOTA\", \"SOUTH DAKOTA\"), \"Division 4\",\n                                                ifelse(non_county_data$area_name %in% c(\"DELAWARE\", \"FLORIDA\", \"GEORGIA\", \"MARYLAND\", \"NORTH CAROLINA\", \"SOUTH CAROLINA\", \"VIRGINIA\", \"DISTRICT OF COLUMBIA\", \"District of Columbia\", \"WEST VIRGINIA\"), \"Division 5\",\n                                                       ifelse(non_county_data$area_name %in% c(\"ALABAMA\", \"KENTUCKY\", \"MISSISSIPPI\", \"TENNESSEE\"), \"Division 6\",\n                                                              ifelse(non_county_data$area_name %in% c(\"ARKANSAS\", \"LOUISIANA\", \"OKLAHOMA\", \"TEXAS\"), \"Division 7\",\n                                                                     ifelse(non_county_data$area_name %in% c(\"ARIZONA\", \"COLORADO\", \"IDAHO\", \"MONTANA\", \"NEVADA\", \"NEW MEXICO\", \"UTAH\", \"WYOMING\"), \"Division 8\",\n                                                                            ifelse(non_county_data$area_name %in% c(\"ALASKA\", \"CALIFORNIA\", \"HAWAII\", \"OREGON\", \"WASHINGTON\"), \"Division 9\",\n                                                                                   \"ERROR\"))))))))))\nnon_county_data\n\n# A tibble: 530 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987 ERROR   \n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988 ERROR   \n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989 ERROR   \n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990 ERROR   \n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991 ERROR   \n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992 ERROR   \n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993 ERROR   \n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994 ERROR   \n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995 ERROR   \n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996 ERROR   \n# ℹ 520 more rows"
  },
  {
    "objectID": "ST558 Project 1 Quarto Doc.html#creating-functions.",
    "href": "ST558 Project 1 Quarto Doc.html#creating-functions.",
    "title": "ST558 Project 1",
    "section": "",
    "text": "Write one function that does steps 1 & 2 above. Give an optional argument that allows the user to specify the name of the column representing the value (enrollment for these data sets).\n\n\nfunction_for_step_1_2 &lt;- function(url, default_var_name = \"value\") {\n  tmp &lt;- read_csv(url) |&gt;\n    select(Area_name, STCOU, ends_with(\"D\")) |&gt;\n    rename(\"area_name\" = \"Area_name\") |&gt;   \n    pivot_longer(cols = is.numeric,\n                 names_to = \"enrollment\",\n                 values_to = default_var_name)\n  return(tmp)\n}\n\n\nWrite another function that takes in the output of step 2 and does step 3 above.\n\n\nfunction_for_step_3 &lt;- function(tmp) {\n  tmp &lt;- tmp |&gt; \n    mutate(measurement = substr(enrollment, 1, 7)) |&gt;\n    mutate(year = substr(enrollment, 8, 9))\n  \n  tmp$year &lt;- year(parse_date_time(tmp$year, \"y\"))\n  return(tmp)\n}\n\n\nWrite a function to do step 5.\n\n\nfunction_for_step_5 &lt;- function(county_data) {\n  county_data &lt;- county_data |&gt; \n    mutate(state = substr(county_data$area_name, nchar(county_data$area_name) - 1, nchar(county_data$area_name)))\n  return(county_data)\n}\n\n\nWrite a function to do step 6.\n\n\nfunction_for_step_6 &lt;- function(non_county_data) {\n  non_county_data &lt;- non_county_data |&gt;\n    mutate(division = ifelse(non_county_data$area_name %in% c(\"CONNECTICUT\", \"MAINE\", \"MASSACHUSETTS\", \"NEW HAMPSHIRE\", \"RHODE ISLAND\", \"VERMONT\"),\"Division 1\", \n                             ifelse(non_county_data$area_name %in% c(\"NEW JERSEY\", \"NEW YORK\", \"PENNSYLVANIA\"), \"Division 2\", \n                                    ifelse(non_county_data$area_name %in% c(\"ILLINOIS\", \"INDIANA\", \"MICHIGAN\", \"OHIO\", \"WISCONSIN\"), \"Division 3\",\n                                           ifelse(non_county_data$area_name %in% c(\"IOWA\", \"KANSAS\", \"MINNESOTA\", \"MISSOURI\", \"NEBRASKA\", \"NORTH DAKOTA\", \"SOUTH DAKOTA\"), \"Division 4\",\n                                                  ifelse(non_county_data$area_name %in% c(\"DELAWARE\", \"FLORIDA\", \"GEORGIA\", \"MARYLAND\", \"NORTH CAROLINA\", \"SOUTH CAROLINA\", \"VIRGINIA\", \"DISTRICT OF COLUMBIA\", \"District of Columbia\", \"WEST VIRGINIA\"), \"Division 5\",\n                                                         ifelse(non_county_data$area_name %in% c(\"ALABAMA\", \"KENTUCKY\", \"MISSISSIPPI\", \"TENNESSEE\"), \"Division 6\",\n                                                                ifelse(non_county_data$area_name %in% c(\"ARKANSAS\", \"LOUISIANA\", \"OKLAHOMA\", \"TEXAS\"), \"Division 7\",\n                                                                       ifelse(non_county_data$area_name %in% c(\"ARIZONA\", \"COLORADO\", \"IDAHO\", \"MONTANA\", \"NEVADA\", \"NEW MEXICO\", \"UTAH\", \"WYOMING\"), \"Division 8\",\n                                                                              ifelse(non_county_data$area_name %in% c(\"ALASKA\", \"CALIFORNIA\", \"HAWAII\", \"OREGON\", \"WASHINGTON\"), \"Division 9\",\n                                                                                     \"ERROR\"))))))))))\n  return(non_county_data)\n}\n\n\nWrite another function that takes in the output from step 3 and creates the two tibbles in step 4, calls the above two functions (to perform steps 5 and 6), and returns two final tibbles.\n\n\nfunction_for_steps4_5_6 &lt;- function(tmp) {\n  county_index &lt;- grep(pattern = \", \\\\w\\\\w\", tmp$area_name)\n  county_data &lt;- tmp[county_index,]\n  class(county_data) &lt;- c(\"county\", class(county_data))\n  non_county_data &lt;- tmp[- county_index,]\n  class(non_county_data) &lt;- c(\"state\", class(non_county_data))\n  county_data &lt;- county_data |&gt; function_for_step_5 ()\n  non_county_data &lt;- non_county_data |&gt; function_for_step_6 ()\n  return(list(county_data, non_county_data))\n} \n\n\nCreating a wrapper function that takes in the URL of a .csv file in this format and the optional argument for the variable name, calls the functions you wrote above, and then returns the two tibbles.\n\n\nmy_wrapper &lt;- function(url, default_var_name = \"value\") {\n  result &lt;- function_for_step_1_2(url, default_var_name) |&gt;\n    function_for_step_3() |&gt;\n    function_for_steps4_5_6 ()\n  return(result)\n}\n\n\n\n\nCall the function two times and parse the two .csv files mentioned so far.\n\n\nedu01a_data_from_wrapper &lt;- my_wrapper(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01a.csv\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010187N1, EDU010187N2, EDU010188N1, EDU010188...\ndbl (20): EDU010187F, EDU010187D, EDU010188F, EDU010188D, EDU010189F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nedu01a_data_from_wrapper\n\n[[1]]\n# A tibble: 31,450 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987 AL   \n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988 AL   \n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989 AL   \n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990 AL   \n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991 AL   \n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992 AL   \n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993 AL   \n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994 AL   \n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995 AL   \n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996 AL   \n# ℹ 31,440 more rows\n\n[[2]]\n# A tibble: 530 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987 ERROR   \n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988 ERROR   \n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989 ERROR   \n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990 ERROR   \n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991 ERROR   \n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992 ERROR   \n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993 ERROR   \n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994 ERROR   \n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995 ERROR   \n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996 ERROR   \n# ℹ 520 more rows\n\nedu01b_data_from_wrapper &lt;-\nmy_wrapper(\"https://www4.stat.ncsu.edu/~online/datasets/EDU01b.csv\")\n\nRows: 3198 Columns: 42\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (22): Area_name, STCOU, EDU010197N1, EDU010197N2, EDU010198N1, EDU010198...\ndbl (20): EDU010197F, EDU010197D, EDU010198F, EDU010198D, EDU010199F, EDU010...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nedu01b_data_from_wrapper\n\n[[1]]\n# A tibble: 31,450 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010197D  8099 EDU0101      1997 AL   \n 2 Autauga, AL 01001 EDU010198D  8211 EDU0101      1998 AL   \n 3 Autauga, AL 01001 EDU010199D  8489 EDU0101      1999 AL   \n 4 Autauga, AL 01001 EDU010200D  8912 EDU0102      2000 AL   \n 5 Autauga, AL 01001 EDU010201D  8626 EDU0102      2001 AL   \n 6 Autauga, AL 01001 EDU010202D  8762 EDU0102      2002 AL   \n 7 Autauga, AL 01001 EDU015203D  9105 EDU0152      2003 AL   \n 8 Autauga, AL 01001 EDU015204D  9200 EDU0152      2004 AL   \n 9 Autauga, AL 01001 EDU015205D  9559 EDU0152      2005 AL   \n10 Autauga, AL 01001 EDU015206D  9652 EDU0152      2006 AL   \n# ℹ 31,440 more rows\n\n[[2]]\n# A tibble: 530 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010197D 44534459 EDU0101      1997 ERROR   \n 2 UNITED STATES 00000 EDU010198D 46245814 EDU0101      1998 ERROR   \n 3 UNITED STATES 00000 EDU010199D 46368903 EDU0101      1999 ERROR   \n 4 UNITED STATES 00000 EDU010200D 46818690 EDU0102      2000 ERROR   \n 5 UNITED STATES 00000 EDU010201D 47127066 EDU0102      2001 ERROR   \n 6 UNITED STATES 00000 EDU010202D 47606570 EDU0102      2002 ERROR   \n 7 UNITED STATES 00000 EDU015203D 48506317 EDU0152      2003 ERROR   \n 8 UNITED STATES 00000 EDU015204D 48693287 EDU0152      2004 ERROR   \n 9 UNITED STATES 00000 EDU015205D 48978555 EDU0152      2005 ERROR   \n10 UNITED STATES 00000 EDU015206D 49140702 EDU0152      2006 ERROR   \n# ℹ 520 more rows\n\n\n\nWrite a single short function that takes in the results of two calls to the wrapper function.\n\n\ncombining_data &lt;- function(tmp_1, tmp_2) {\n  county_data_combined &lt;- dplyr::bind_rows(tmp_1[[1]], tmp_2[[1]])\n  non_county_data_combined &lt;- dplyr::bind_rows(tmp_1[[2]], tmp_2[[2]])\n  tmp_3 &lt;- list(county_data_combined, non_county_data_combined)\n  return(tmp_3)\n}\n\ndata_combined &lt;- combining_data(edu01a_data_from_wrapper, edu01b_data_from_wrapper)\ndata_combined\n\n[[1]]\n# A tibble: 62,900 × 7\n   area_name   STCOU enrollment value measurement  year state\n   &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;\n 1 Autauga, AL 01001 EDU010187D  6829 EDU0101      1987 AL   \n 2 Autauga, AL 01001 EDU010188D  6900 EDU0101      1988 AL   \n 3 Autauga, AL 01001 EDU010189D  6920 EDU0101      1989 AL   \n 4 Autauga, AL 01001 EDU010190D  6847 EDU0101      1990 AL   \n 5 Autauga, AL 01001 EDU010191D  7008 EDU0101      1991 AL   \n 6 Autauga, AL 01001 EDU010192D  7137 EDU0101      1992 AL   \n 7 Autauga, AL 01001 EDU010193D  7152 EDU0101      1993 AL   \n 8 Autauga, AL 01001 EDU010194D  7381 EDU0101      1994 AL   \n 9 Autauga, AL 01001 EDU010195D  7568 EDU0101      1995 AL   \n10 Autauga, AL 01001 EDU010196D  7834 EDU0101      1996 AL   \n# ℹ 62,890 more rows\n\n[[2]]\n# A tibble: 1,060 × 7\n   area_name     STCOU enrollment    value measurement  year division\n   &lt;chr&gt;         &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;   \n 1 UNITED STATES 00000 EDU010187D 40024299 EDU0101      1987 ERROR   \n 2 UNITED STATES 00000 EDU010188D 39967624 EDU0101      1988 ERROR   \n 3 UNITED STATES 00000 EDU010189D 40317775 EDU0101      1989 ERROR   \n 4 UNITED STATES 00000 EDU010190D 40737600 EDU0101      1990 ERROR   \n 5 UNITED STATES 00000 EDU010191D 41385442 EDU0101      1991 ERROR   \n 6 UNITED STATES 00000 EDU010192D 42088151 EDU0101      1992 ERROR   \n 7 UNITED STATES 00000 EDU010193D 42724710 EDU0101      1993 ERROR   \n 8 UNITED STATES 00000 EDU010194D 43369917 EDU0101      1994 ERROR   \n 9 UNITED STATES 00000 EDU010195D 43993459 EDU0101      1995 ERROR   \n10 UNITED STATES 00000 EDU010196D 44715737 EDU0101      1996 ERROR   \n# ℹ 1,050 more rows"
  },
  {
    "objectID": "ST558 Project 1 Quarto Doc.html#writing-a-generic-function-for-summarizing.",
    "href": "ST558 Project 1 Quarto Doc.html#writing-a-generic-function-for-summarizing.",
    "title": "ST558 Project 1",
    "section": "",
    "text": "Write a function that plots the mean value of the statistic (enrollment for this data set) across the years for each Division. That is, on the x-axis we want the numeric year value, on the y-axis we want the mean of the statistic for each Division and numeric year. Remove observations at the ERROR setting of Division.\nplot the data with year as x-axis and mean enrollment value as y-axis for different divisions\n\n\nplot.state &lt;- function(combined_state_data, default_var_name = value) {\n  combined_state_data &lt;- combined_state_data |&gt;\n    filter(division != \"ERROR\") |&gt;\n    group_by(division, year) |&gt;\n    summarize(mean_value = mean({{default_var_name}}))\n\n  ggplot(combined_state_data, aes(x = year, y = mean_value, color = division)) +\n    geom_line() +\n    labs(x = \"Year\",\n         y = \"Mean Enrollment Value\",\n         color = \"Division\",\n         title = \"Mean Enrollment Value by Year and Division\")\n}\n\nplot.state(combined_state_data = data_combined[[2]], default_var_name = value)\n\n`summarise()` has grouped output by 'division'. You can override using the\n`.groups` argument.\n\n\n\n\n\n\n\n\n\n\n\n\n\nfilter the data to only include data from the state specified\nfind the overall mean of the statistic (use get(var_name) here as well) for each Area_name and sort those values from largest to smallest if ‘top’ is specified or smallest to largest if ‘bottom’ is specified\nobtain the top or bottom x number of Area_names from the previous step where x is given by the user or the default\nfilter the data for this state to only include the Area_name’s from the previous part\nplot the data with year as x-axis and original enrollment value as y-axis for counties refereed in query\n\n\nplot.county &lt;- function(combined_county_data, default_state = \"NC\", default_var_name = value, top_or_bottom = \"top\", default_obs = 5){\n  \n  if (top_or_bottom == \"top\") {\n    area_name_for_plot &lt;- combined_county_data |&gt;\n      filter(state == default_state) |&gt;\n      group_by(area_name) |&gt;\n      summarize(mean_value = mean({{default_var_name}})) |&gt;\n      arrange(desc(mean_value)) |&gt;\n      slice(1:default_obs) |&gt;\n      pull(area_name)\n    \n    area_name_for_plot\n  } else if (top_or_bottom == \"bottom\") {\n    area_name_for_plot &lt;- combined_county_data |&gt;\n      filter(state == default_state) |&gt;\n      group_by(area_name) |&gt;\n      summarize(mean_value = mean({{default_var_name}})) |&gt;\n      arrange(mean_value) |&gt;\n      slice(1:default_obs) |&gt;\n      pull(area_name)\n    \n    area_name_for_plot\n  } \n  \n  plot_state &lt;- data_combined[[1]] |&gt;\n    filter(area_name %in% area_name_for_plot)\n  \n  ggplot(plot_state, aes(x = year, y = value, color = area_name)) +\n    geom_line() +\n    labs(x = \"Year\",\n         y = \"Enrollment Value\",\n         color = \"Area_name\",\n         title = \"Enrollment Value by Year in Counties Referred\")\n}\n\nplot.county(combined_county_data = data_combined[[1]], default_state = \"CA\", default_var_name = value, top_or_bottom = \"bottom\", default_obs = 10)"
  }
]